"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{2869:function(e,t,r){r.d(t,{d:function(){return c},z:function(){return s}});var n=r(7437),o=r(2265),i=r(7053),a=r(535),d=r(4508);let c=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),s=o.forwardRef((e,t)=>{let{className:r,variant:o,size:a,asChild:s=!1,...u}=e,l=s?i.g7:"button";return(0,n.jsx)(l,{className:(0,d.cn)(c({variant:o,size:a,className:r})),ref:t,...u})});s.displayName="Button"},6070:function(e,t,r){r.d(t,{SZ:function(){return c},Zb:function(){return a},aY:function(){return s},ll:function(){return d}});var n=r(7437),o=r(2265),i=r(4508);let a=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...o})});a.displayName="Card",o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...o})}).displayName="CardHeader";let d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...o})});d.displayName="CardTitle";let c=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...o})});c.displayName="CardDescription";let s=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...o})});s.displayName="CardContent",o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...o})}).displayName="CardFooter"},7992:function(e,t,r){r.d(t,{pm:function(){return f}});var n=r(2265);let o=0,i=new Map,a=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),u({type:"REMOVE_TOAST",toastId:e})},5e3);i.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],s={toasts:[]};function u(e){s=d(s,e),c.forEach(e=>{e(s)})}function l(e){let{...t}=e,r=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>u({type:"DISMISS_TOAST",toastId:r});return u({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(s);return n.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:l,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}},7440:function(e,t,r){r.d(t,{G:function(){return u},V:function(){return s}});var n=r(7437),o=r(2265),i=r(7992);let a="completed_downloads",d="download_history",c=(0,o.createContext)(void 0);function s(e){let{children:t}=e,{toast:r}=(0,i.pm)(),s=(0,o.useRef)(new Set),u=(0,o.useRef)({active:[],minimized:[],current:null}),[l,f]=(0,o.useState)([]),[m,v]=(0,o.useState)([]),[p,w]=(0,o.useState)([]),[g,h]=(0,o.useState)([]),[S,y]=(0,o.useState)(null),x=e=>{let t=new Map;return e.forEach(e=>{t.set(e.id,e)}),Array.from(t.values())};return(0,o.useEffect)(()=>{u.current.active=l},[l]),(0,o.useEffect)(()=>{u.current.minimized=g},[g]),(0,o.useEffect)(()=>{u.current.current=S},[S]),(0,o.useEffect)(()=>{try{let e=sessionStorage.getItem(a);e&&v(JSON.parse(e))}catch(e){console.error("Failed to load completed downloads from sessionStorage:",e)}try{let e=localStorage.getItem(d);e&&w(JSON.parse(e))}catch(e){console.error("Failed to load download history from localStorage:",e)}},[]),(0,o.useEffect)(()=>{if(m.length>0)try{sessionStorage.setItem(a,JSON.stringify(m))}catch(e){console.error("Failed to save completed downloads to sessionStorage:",e)}},[m]),(0,o.useEffect)(()=>{if(p.length>0)try{localStorage.setItem(d,JSON.stringify(p))}catch(e){console.error("Failed to save download history to localStorage:",e)}},[p]),(0,o.useEffect)(()=>{let e=e=>{f(t=>{if(t.some(t=>t.id===e.id)){let r=t.map(t=>t.id===e.id?e:t);return u.current.active=r,r}{let r=[...t,e];return u.current.active=r,r}}),y(e),u.current.current=e},t=(e,t)=>{var r;let n=r=>r.id===e?{...r,progress:t}:r,o=u.current.active.map(n);if(f(x(o)),u.current.active=o,h(e=>{let t=e.map(n);return u.current.minimized=t,t}),(null===(r=u.current.current)||void 0===r?void 0:r.id)===e){let e={...u.current.current,progress:t};y(e),u.current.current=e}},n=(e,t)=>{var r;let n=r=>r.id===e?{...r,phase:t}:r;if(f(e=>{let t=e.map(n);return u.current.active=x(t),x(t)}),h(t=>{if(t.some(t=>t.id===e)){let e=t.map(n);return u.current.minimized=e,e}return t}),(null===(r=u.current.current)||void 0===r?void 0:r.id)===e){let e={...u.current.current,phase:t};y(e),u.current.current=e}},o=e=>{var t;if(s.current.has(e.id)){console.log("Already notified for download:",e.id);return}s.current.add(e.id),r({title:"Download Complete",description:"".concat(e.title||"Video"," has been downloaded successfully."),variant:"success",duration:5e3}),v(t=>t.some(t=>t.id===e.id)?t:[...t,e]);let n={...e,completedAt:new Date().toISOString()};w(t=>t.some(t=>t.id===e.id)?t.map(t=>t.id===e.id?n:t):[...t,n]),f(t=>{let r=t.filter(t=>t.id!==e.id);return u.current.active=r,r}),h(t=>{let r=t.filter(t=>t.id!==e.id);return u.current.minimized=r,r}),(null===(t=u.current.current)||void 0===t?void 0:t.id)===e.id&&(y(null),u.current.current=null)},i=(e,t)=>{r({title:"Download Failed",description:t||"An error occurred during download.",variant:"destructive",duration:5e3}),f(r=>{let n=r.find(t=>t.id===e);if(n){let r={...n,status:"error",error:t||"Unknown error",completedAt:new Date().toISOString()};w(t=>t.some(t=>t.id===e)?t.map(t=>t.id===e?r:t):[...t,r])}let o=r.map(r=>r.id===e?{...r,status:"error",error:t}:r);return u.current.active=x(o),x(o)})};(async()=>{try{let e=await window.api.getActiveDownloads(),t=x(e);f(t),u.current.active=t}catch(e){console.error("Failed to fetch active downloads:",e)}})();let a=setInterval(()=>{let e=x(u.current.active);JSON.stringify(e)!==JSON.stringify(l)&&f(e)},500);return window.api.on("new-download",e),window.api.on("download-progress",t),window.api.on("phase-change",n),window.api.on("download-complete",o),window.api.on("download-error",i),()=>{clearInterval(a),window.api.off("new-download",e),window.api.off("download-progress",t),window.api.off("phase-change",n),window.api.off("download-complete",o),window.api.off("download-error",i)}},[r]),(0,n.jsx)(c.Provider,{value:{activeDownloads:l,completedDownloads:m,downloadHistory:p,minimizedDownloads:g,activeDownload:S,minimizeDownload:e=>{var t;let r=u.current.active.find(t=>t.id===e);r&&!u.current.minimized.some(t=>t.id===e)&&h(e=>{let t=[...e,r];return u.current.minimized=t,t}),(null===(t=u.current.current)||void 0===t?void 0:t.id)===e&&(y(null),u.current.current=null)},restoreDownload:e=>{let t=u.current.active.find(t=>t.id===e);t&&(y(t),u.current.current=t,h(t=>{let r=t.filter(t=>t.id!==e);return u.current.minimized=r,r}))},removeDownload:e=>{var t;f(t=>{let r=t.filter(t=>t.id!==e);return u.current.active=r,r}),(null===(t=u.current.current)||void 0===t?void 0:t.id)===e&&(y(null),u.current.current=null),h(t=>{let r=t.filter(t=>t.id!==e);return u.current.minimized=r,r})},clearHistory:()=>{w([]),localStorage.removeItem(d),r({title:"History Cleared",description:"Your download history has been cleared.",duration:3e3})}},children:t})}function u(){let e=(0,o.useContext)(c);if(void 0===e)throw Error("useDownloads must be used within a DownloadProvider");return e}},4508:function(e,t,r){r.d(t,{LU:function(){return a},cn:function(){return i},xR:function(){return d}});var n=r(1994),o=r(3335);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}function a(e){if(!e||e<0)return"0:00";let t=Math.floor((e=Math.floor(e))/3600),r=Math.floor(e%3600/60),n=e%60,o="";return t>0?o+="".concat(t,":")+"".concat(r.toString().padStart(2,"0"),":"):o+="".concat(r,":"),o+=n.toString().padStart(2,"0")}function d(e){return e?e>=1e9?"".concat((e/1e9).toFixed(1),"B views"):e>=1e6?"".concat((e/1e6).toFixed(1),"M views"):e>=1e3?"".concat((e/1e3).toFixed(1),"K views"):"".concat(e," views"):"0 views"}}}]);